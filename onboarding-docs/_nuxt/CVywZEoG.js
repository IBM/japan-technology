import{u as B,a as D,c as U}from"./wRPnsAVM.js";import{u as $}from"./hkeGVr4C.js";import{S as T,P as k}from"./VrjSw3dp.js";import{q as v,e as F,am as G,i as R,ad as L,aW as V,X as y,l as K,ac as j,p as z,f as Y,o as H,w as C,b as W,h,s as X}from"./ZwSKFrxj.js";function _(){let e=document.activeElement;if(e==null)return null;for(;e!=null&&e.shadowRoot!=null&&e.shadowRoot.activeElement!=null;)e=e.shadowRoot.activeElement;return e}function M(){const e=v(),o=F(()=>["#text","#comment"].includes(e.value?.$el.nodeName)?e.value?.$el.nextElementSibling:B(e));return{primitiveElement:e,currentElement:o}}const x="data-reka-collection-item";function J(e={}){const{key:o="",isProvider:i=!1}=e,t=`${o}CollectionProvider`;let r;if(i){const a=v(new Map);r={collectionRef:v(),itemMap:a},j(t,r)}else r=G(t);const A=(a=!1)=>{const n=r.collectionRef.value;if(!n)return[];const s=Array.from(n.querySelectorAll(`[${x}]`)),d=Array.from(r.itemMap.value.values()).sort((f,m)=>s.indexOf(f.ref)-s.indexOf(m.ref));return a?d:d.filter(f=>f.ref.dataset.disabled!=="")},w=R({name:"CollectionSlot",setup(a,{slots:n}){const{primitiveElement:s,currentElement:c}=M();return K(c,()=>{r.collectionRef.value=c.value}),()=>y(T,{ref:s},n)}}),I=R({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(a,{slots:n,attrs:s}){const{primitiveElement:c,currentElement:d}=M();return L(f=>{if(d.value){const m=V(d.value);r.itemMap.value.set(m,{ref:d.value,value:a.value}),f(()=>r.itemMap.value.delete(m))}}),()=>y(T,{...s,[x]:"",ref:c},n)}}),S=F(()=>Array.from(r.itemMap.value.values())),g=F(()=>r.itemMap.value.size);return{getItems:A,reactiveItems:S,itemMapSize:g,CollectionSlot:w,CollectionItem:I}}const Q="rovingFocusGroup.onEntryFocus",Z={bubbles:!1,cancelable:!0},ee={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function te(e,o){return o!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ue(e,o,i){const t=te(e.key,i);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(t))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(t)))return ee[t]}function oe(e,o=!1){const i=_();for(const t of e)if(t===i||(t.focus({preventScroll:o}),_()!==i))return}function ce(e,o){return e.map((i,t)=>e[(o+t)%e.length])}const[de,re]=U("RovingFocusGroup");var ne=R({__name:"RovingFocusGroup",props:{orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!1},currentTabStopId:{type:[String,null],required:!1},defaultCurrentTabStopId:{type:String,required:!1},preventScrollOnEntryFocus:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["entryFocus","update:currentTabStopId"],setup(e,{expose:o,emit:i}){const t=e,r=i,{loop:A,orientation:w,dir:I}=z(t),S=$(I),g=D(t,"currentTabStopId",r,{defaultValue:t.defaultCurrentTabStopId,passive:t.currentTabStopId===void 0}),a=v(!1),n=v(!1),s=v(0),{getItems:c,CollectionSlot:d}=J({isProvider:!0});function f(l){const p=!n.value;if(l.currentTarget&&l.target===l.currentTarget&&p&&!a.value){const E=new CustomEvent(Q,Z);if(l.currentTarget.dispatchEvent(E),r("entryFocus",E),!E.defaultPrevented){const b=c().map(u=>u.ref).filter(u=>u.dataset.disabled!==""),O=b.find(u=>u.getAttribute("data-active")===""),P=b.find(u=>u.getAttribute("data-highlighted")===""),q=b.find(u=>u.id===g.value),N=[O,P,q,...b].filter(Boolean);oe(N,t.preventScrollOnEntryFocus)}}n.value=!1}function m(){setTimeout(()=>{n.value=!1},1)}return o({getItems:c}),re({loop:A,dir:S,orientation:w,currentTabStopId:g,onItemFocus:l=>{g.value=l},onItemShiftTab:()=>{a.value=!0},onFocusableItemAdd:()=>{s.value++},onFocusableItemRemove:()=>{s.value--}}),(l,p)=>(H(),Y(h(d),null,{default:C(()=>[W(h(k),{tabindex:a.value||s.value===0?-1:0,"data-orientation":h(w),as:l.as,"as-child":l.asChild,dir:h(S),style:{outline:"none"},onMousedown:p[0]||(p[0]=E=>n.value=!0),onMouseup:m,onFocus:f,onBlur:p[1]||(p[1]=E=>a.value=!1)},{default:C(()=>[X(l.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),fe=ne;export{ee as M,fe as R,J as a,_ as b,oe as f,ue as g,de as i,M as u,ce as w};
